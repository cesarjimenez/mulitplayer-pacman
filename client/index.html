<html>
<head>
  <style>
    table {
      border: 1px solid black;
    }

    td {
      padding: 5em;
    }

    td:hover {
      background-color: red;
    }
  </style>
</head>
<body onload="init()">
  <table>
    <tr>
      <td id="td00">(0, 0)</td>
      <td id="td01">(0, 1)</td>
    </tr>
    <tr>
      <td id="td10">(1, 0)</td>
      <td id="td11">(1, 1)</td>
    </tr>
  </table>
  
  <div id="status"></div>

  <script>

    var DataSender = {

      /*
       * Sends data to server.
       * 
       * @param x X coordinate
       * @param y Y coordinate
       * @param {requestCallback} callback - The callback that handles the response
       */
      send: function(x, y, callback) {
        return function() {
          console.log(x + ", " + y);
          var coords = new Object();
          coords.x = x;
          coords.y = y;
          var client = new XMLHttpRequest();
          client.open("POST", "/newdata/pacman");
          client.onload = function() {
            callback(this.responseText);
          };
          client.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
          client.send("newdata=" + JSON.stringify(coords));
        }
      }
    }

    function init() {
      var maxX = 1;
      var maxY = 1;

      for (var i = 0; i <= maxX; i++) {
        for (var j = 0; j <= maxY; j++) {
          var td = document.getElementById("td" + i + j);
          var onClickFunctionRef = DataSender.send(i, j, onDataSent);
          td.onclick = onClickFunctionRef;
        }
      }
    }

    function onDataSent(json) {
      document.getElementById("status").innerHTML = json;
    }
  </script>
</body>
</html>
